{% extends "base.html" %}

{% block content %}

<div class="container">

    <!-- ==== –ì–ï–†–û–ô-–ë–õ–û–ö (–≤–µ—Ä—Ö–Ω–∏–π –±–∞–Ω–Ω–µ—Ä) ==== -->
    <section class="hero-section">
        <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ø–µ—Ä–≤–æ–∫—É—Ä—Å–Ω–∏–∫! üéì</h1>
        <p>
            –ó–¥–µ—Å—å —Ç—ã –Ω–∞–π–¥—ë—à—å –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –∂–∏–∑–Ω–∏ –≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ, 
            —Ä–∞–∑–±–µ—Ä—ë—à—å—Å—è —Å –∫–∞–º–ø—É—Å–æ–º, —É–∑–Ω–∞–µ—à—å, –∫—É–¥–∞ –∏–¥—Ç–∏ –∏ —á—Ç–æ –¥–µ–ª–∞—Ç—å. 
            –Ø ‚Äî —Ç–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç, –≥–æ—Ç–æ–≤ –ø–æ–º–æ—á—å!
        </p>
        <a class="hero-button" href="{{ url_for('show_map') }}">üó∫ –ü–µ—Ä–µ–π—Ç–∏ –∫ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ä—Ç–µ</a>
    </section>


    <!-- ==== –ß–ê–¢-–ü–û–ú–û–©–ù–ò–ö ==== -->
    <section class="chat-section">
    <h2>üí¨ –ó–∞–¥–∞–π—Ç–µ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å</h2>

    <div class="chat-box">
        <div class="assistant-avatar">
            <img src="https://cdn-icons-png.flaticon.com/512/4712/4712109.png">
        </div>

        <div class="chat-right">
            <div id="chat-messages" class="chat-messages">
                <div class="message bot-message">
                    –ü—Ä–∏–≤–µ—Ç! –Ø —Ç–≤–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫. –°–ø—Ä–æ—Å–∏ –º–µ–Ω—è –æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö,
                    –∫–æ—Ä–ø—É—Å–∞—Ö, —É—á—ë–±–µ –∏–ª–∏ –∂–∏–∑–Ω–∏ –Ω–∞ –∫–∞–º–ø—É—Å–µ!
                </div>
            </div>

            <div class="input-area">
                <input type="text" id="user-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å...">
                <button onclick="sendQuestion()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>
</section>


    <!-- ==== –ö–û–†–û–¢–ö–ò–ô FAQ ==== -->
    <section class="faq-section">
    <h2>‚ùì –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h2>

    <div class="faq-preview">
        {% for item in faq[:5] %}
        <div class="faq-card">
            <div class="faq-card-q">{{ item.question }}</div>
            <div class="faq-card-a">{{ item.answer | safe }}</div>
        </div>
        {% endfor %}
    </div>

    <div class="faq-more-container">
        <a class="faq-more-button" href="{{ url_for('faq_full') }}">
            üìò –°–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã
        </a>
    </div>
</section>


    <!-- ==== –ü–û–õ–ï–ó–ù–´–ï –°–°–´–õ–ö–ò ==== -->
    <section class="links-section">
    <h2>üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏</h2>

    <div class="link-cards">
        {% for link in links %}
        <a class="link-card" href="{{ link.url }}" target="_blank">
            <div class="link-icon">üîó</div>
            <div class="link-name">{{ link.name }}</div>
        </a>
        {% endfor %}
    </div>
</section>

</div>



<!-- ==== JS –¥–ª—è —á–∞—Ç–∞ ==== -->
<script>
function sendQuestion() {
    const input = document.getElementById('user-input');
    const question = input.value.trim();
    if (!question) return;

    const chatMessages = document.getElementById('chat-messages');
    chatMessages.innerHTML += `<div class="message user-message">${question}</div>`;

    fetch('/ask', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: `question=${encodeURIComponent(question)}`
    })
    .then(r => r.json())
    .then(data => {
        chatMessages.innerHTML += `<div class="message bot-message">${data.answer}</div>`;
        chatMessages.scrollTop = chatMessages.scrollHeight;
    });

    input.value = '';
}

document.getElementById('user-input').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') sendQuestion();
});
</script>

{% endblock %}
